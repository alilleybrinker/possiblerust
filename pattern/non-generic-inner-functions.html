<!doctype html>
<html class="no-js" lang="en-US">
    <head>
        <meta charset="utf-8">

        
            <title>Non-Generic Inner Functions - Possible Rust</title>
        

        <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">

        
            <meta name="description" content="Learning what&rsquo;s possible in Rust.">
        
        
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="manifest" href="site.webmanifest">
        <link rel="apple-touch-icon" href="icon.png">

        <link rel="stylesheet" href="/css/main.css">

        <meta name="theme-color" content="#e4edf6">

        <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Non-Generic Inner Functions" />
<meta name="author" content="Andrew Lilley Brinker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Steve Klabnik recently wrote about whether out parameters are idiomatic in Rust. The post ends by showing a snippet of code: a generic function, with a non-generic function inside of it which contains the actual implementation. Steve says this pattern may warrant its own post, so here is that post, where I’ll explain why this inner function is useful, discuss the trade-offs of doing it, and describe why this pattern will hopefully not be necessary in the future." />
<meta property="og:description" content="Steve Klabnik recently wrote about whether out parameters are idiomatic in Rust. The post ends by showing a snippet of code: a generic function, with a non-generic function inside of it which contains the actual implementation. Steve says this pattern may warrant its own post, so here is that post, where I’ll explain why this inner function is useful, discuss the trade-offs of doing it, and describe why this pattern will hopefully not be necessary in the future." />
<link rel="canonical" href="https://www.possiblerust.com/pattern/non-generic-inner-functions" />
<meta property="og:url" content="https://www.possiblerust.com/pattern/non-generic-inner-functions" />
<meta property="og:site_name" content="Possible Rust" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-20T18:19:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Non-Generic Inner Functions" />
<meta name="twitter:site" content="@possiblerust" />
<meta name="twitter:creator" content="@alilleybrinker" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.possiblerust.com/pattern/non-generic-inner-functions"},"author":{"@type":"Person","name":"Andrew Lilley Brinker"},"headline":"Non-Generic Inner Functions","url":"https://www.possiblerust.com/pattern/non-generic-inner-functions","datePublished":"2020-10-20T18:19:00-07:00","description":"Steve Klabnik recently wrote about whether out parameters are idiomatic in Rust. The post ends by showing a snippet of code: a generic function, with a non-generic function inside of it which contains the actual implementation. Steve says this pattern may warrant its own post, so here is that post, where I’ll explain why this inner function is useful, discuss the trade-offs of doing it, and describe why this pattern will hopefully not be necessary in the future.","dateModified":"2020-10-20T18:19:00-07:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    </head>
    <body class=" post-page">
        <div id="top"></div>
        <div class="site">
            <div class="mobile-only">
                
                    
<h1 class="site-title site-title--small"><a href="/" class="plain"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>gear</title>
<path d="M30.391 12.68l-3.064-0.614c-0.154-0.443-0.336-0.873-0.537-1.289l1.736-2.604c0.529-0.793 0.424-1.85-0.25-2.523l-1.924-1.924c-0.387-0.387-0.898-0.586-1.416-0.586-0.383 0-0.77 0.11-1.107 0.336l-2.604 1.735c-0.418-0.202-0.848-0.382-1.291-0.536l-0.614-3.065c-0.186-0.936-1.008-1.608-1.961-1.608h-2.72c-0.953 0-1.774 0.673-1.961 1.608l-0.614 3.065c-0.443 0.154-0.873 0.335-1.289 0.536l-2.603-1.735c-0.339-0.226-0.725-0.336-1.109-0.336-0.517 0-1.028 0.199-1.415 0.586l-1.923 1.924c-0.674 0.674-0.779 1.73-0.25 2.523l1.735 2.604c-0.202 0.417-0.382 0.847-0.536 1.29l-3.066 0.613c-0.935 0.187-1.608 1.008-1.608 1.961v2.72c0 0.953 0.673 1.775 1.608 1.961l3.065 0.615c0.154 0.443 0.335 0.873 0.536 1.289l-1.734 2.604c-0.529 0.793-0.424 1.85 0.25 2.523l1.924 1.924c0.387 0.387 0.898 0.586 1.415 0.586 0.384 0 0.771-0.111 1.108-0.336l2.604-1.736c0.417 0.203 0.847 0.383 1.29 0.537l0.613 3.064c0.187 0.936 1.008 1.609 1.961 1.609h2.72c0.953 0 1.775-0.674 1.961-1.609l0.615-3.064c0.443-0.154 0.873-0.336 1.289-0.537l2.604 1.736c0.338 0.225 0.725 0.336 1.107 0.336 0.518 0 1.029-0.199 1.416-0.586l1.924-1.924c0.674-0.674 0.779-1.73 0.25-2.523l-1.736-2.604c0.203-0.418 0.383-0.848 0.537-1.291l3.064-0.613c0.935-0.185 1.609-1.008 1.609-1.961v-2.72c0-0.953-0.674-1.774-1.609-1.961zM26.934 17.975c-0.695 0.139-1.264 0.635-1.496 1.305-0.129 0.369-0.279 0.727-0.447 1.074-0.311 0.639-0.258 1.393 0.135 1.982l1.736 2.604-1.924 1.924-2.604-1.736c-0.334-0.223-0.721-0.336-1.109-0.336-0.297 0-0.596 0.066-0.871 0.199-0.348 0.168-0.705 0.32-1.076 0.449-0.668 0.232-1.164 0.801-1.303 1.496l-0.615 3.066h-2.72l-0.613-3.066c-0.139-0.695-0.635-1.264-1.304-1.496-0.369-0.129-0.728-0.279-1.075-0.447-0.276-0.135-0.574-0.201-0.872-0.201-0.389 0-0.775 0.113-1.109 0.336l-2.604 1.736-1.924-1.924 1.735-2.604c0.393-0.59 0.444-1.344 0.137-1.98-0.168-0.348-0.319-0.705-0.448-1.076-0.232-0.668-0.802-1.164-1.496-1.303l-3.065-0.615-0.002-2.721 3.066-0.613c0.694-0.139 1.264-0.635 1.496-1.304 0.129-0.369 0.278-0.728 0.447-1.075 0.31-0.638 0.258-1.392-0.136-1.981l-1.734-2.604 1.923-1.924 2.604 1.735c0.334 0.223 0.721 0.336 1.109 0.336 0.297 0 0.595-0.066 0.871-0.199 0.347-0.168 0.705-0.319 1.075-0.448 0.669-0.232 1.165-0.802 1.304-1.496l0.614-3.065 2.72-0.001 0.613 3.066c0.139 0.694 0.635 1.264 1.305 1.496 0.369 0.129 0.727 0.278 1.074 0.447 0.277 0.134 0.574 0.2 0.873 0.2 0.389 0 0.775-0.113 1.109-0.336l2.604-1.735 1.924 1.924-1.736 2.604c-0.393 0.59-0.443 1.343-0.137 1.98 0.168 0.347 0.32 0.705 0.449 1.075 0.232 0.669 0.801 1.165 1.496 1.304l3.064 0.614 0.003 2.72-3.066 0.614zM16 9.001c-3.865 0-7 3.135-7 7 0 3.866 3.135 7 7 7s7-3.135 7-7c0-3.865-3.135-7-7-7zM16 22.127c-3.382 0-6.125-2.744-6.125-6.125s2.743-6.125 6.125-6.125c3.381 0 6.125 2.743 6.125 6.125 0 3.381-2.744 6.125-6.125 6.125zM16 12.001c-2.21 0-4 1.79-4 4s1.79 4 4 4c2.209 0 4-1.791 4-4s-1.791-4-4-4zM16 19.002c-1.656 0-3-1.344-3-3s1.344-3 3-3 3 1.344 3 3c0 1.656-1.344 3-3 3z"></path>
</svg>
<!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>idea</title>
<path d="M16 0c-6.076 0-11 4.924-11 11 0 4.031 3.688 8.303 5.031 12.055 2.003 5.595 1.781 8.945 5.969 8.945 4.25 0 3.965-3.334 5.969-8.922 1.347-3.76 5.031-8.078 5.031-12.078 0-6.076-4.926-11-11-11zM18.592 27.176l-4.958 0.619c-0.177-0.512-0.367-1.111-0.598-1.893-0.003-0.010-0.007-0.021-0.009-0.031l6.188-0.773c-0.088 0.295-0.182 0.605-0.264 0.883-0.131 0.449-0.248 0.839-0.359 1.195zM12.736 24.908c-0.182-0.602-0.387-1.236-0.615-1.908h7.766c-0.123 0.359-0.246 0.719-0.352 1.059l-6.799 0.849zM16 30c-1.013 0-1.479-0.117-1.997-1.25l4.238-0.531c-0.614 1.654-1.061 1.781-2.241 1.781zM20.672 21h-9.333c-0.498-1.080-1.096-2.16-1.686-3.217-1.305-2.335-2.653-4.75-2.653-6.783 0-4.963 4.037-9 9-9s9 4.037 9 9c0 2.018-1.35 4.446-2.656 6.795-0.584 1.053-1.178 2.131-1.672 3.205zM16 5c0.275 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5c-2.757 0-5 2.243-5 5 0 0.276-0.224 0.5-0.5 0.5s-0.5-0.224-0.5-0.5c0-3.309 2.691-6 6-6z"></path>
</svg>
<br>Possible Rust</a></h1>
<p class="site-desc">Learning what&rsquo;s possible in Rust.<span class="mobile-only"><br><a class="to-nav" href="#nav">Jump to Navigation</a></span></p>

                
            </div>

            <div class="site-body">
                <header class="site-header" id="nav">
    <div class="mobile-only"><br><a class="to-nav" href="#top">Jump to the top</a></div>

    
<h1 class="site-title site-title--small"><a href="/" class="plain"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>gear</title>
<path d="M30.391 12.68l-3.064-0.614c-0.154-0.443-0.336-0.873-0.537-1.289l1.736-2.604c0.529-0.793 0.424-1.85-0.25-2.523l-1.924-1.924c-0.387-0.387-0.898-0.586-1.416-0.586-0.383 0-0.77 0.11-1.107 0.336l-2.604 1.735c-0.418-0.202-0.848-0.382-1.291-0.536l-0.614-3.065c-0.186-0.936-1.008-1.608-1.961-1.608h-2.72c-0.953 0-1.774 0.673-1.961 1.608l-0.614 3.065c-0.443 0.154-0.873 0.335-1.289 0.536l-2.603-1.735c-0.339-0.226-0.725-0.336-1.109-0.336-0.517 0-1.028 0.199-1.415 0.586l-1.923 1.924c-0.674 0.674-0.779 1.73-0.25 2.523l1.735 2.604c-0.202 0.417-0.382 0.847-0.536 1.29l-3.066 0.613c-0.935 0.187-1.608 1.008-1.608 1.961v2.72c0 0.953 0.673 1.775 1.608 1.961l3.065 0.615c0.154 0.443 0.335 0.873 0.536 1.289l-1.734 2.604c-0.529 0.793-0.424 1.85 0.25 2.523l1.924 1.924c0.387 0.387 0.898 0.586 1.415 0.586 0.384 0 0.771-0.111 1.108-0.336l2.604-1.736c0.417 0.203 0.847 0.383 1.29 0.537l0.613 3.064c0.187 0.936 1.008 1.609 1.961 1.609h2.72c0.953 0 1.775-0.674 1.961-1.609l0.615-3.064c0.443-0.154 0.873-0.336 1.289-0.537l2.604 1.736c0.338 0.225 0.725 0.336 1.107 0.336 0.518 0 1.029-0.199 1.416-0.586l1.924-1.924c0.674-0.674 0.779-1.73 0.25-2.523l-1.736-2.604c0.203-0.418 0.383-0.848 0.537-1.291l3.064-0.613c0.935-0.185 1.609-1.008 1.609-1.961v-2.72c0-0.953-0.674-1.774-1.609-1.961zM26.934 17.975c-0.695 0.139-1.264 0.635-1.496 1.305-0.129 0.369-0.279 0.727-0.447 1.074-0.311 0.639-0.258 1.393 0.135 1.982l1.736 2.604-1.924 1.924-2.604-1.736c-0.334-0.223-0.721-0.336-1.109-0.336-0.297 0-0.596 0.066-0.871 0.199-0.348 0.168-0.705 0.32-1.076 0.449-0.668 0.232-1.164 0.801-1.303 1.496l-0.615 3.066h-2.72l-0.613-3.066c-0.139-0.695-0.635-1.264-1.304-1.496-0.369-0.129-0.728-0.279-1.075-0.447-0.276-0.135-0.574-0.201-0.872-0.201-0.389 0-0.775 0.113-1.109 0.336l-2.604 1.736-1.924-1.924 1.735-2.604c0.393-0.59 0.444-1.344 0.137-1.98-0.168-0.348-0.319-0.705-0.448-1.076-0.232-0.668-0.802-1.164-1.496-1.303l-3.065-0.615-0.002-2.721 3.066-0.613c0.694-0.139 1.264-0.635 1.496-1.304 0.129-0.369 0.278-0.728 0.447-1.075 0.31-0.638 0.258-1.392-0.136-1.981l-1.734-2.604 1.923-1.924 2.604 1.735c0.334 0.223 0.721 0.336 1.109 0.336 0.297 0 0.595-0.066 0.871-0.199 0.347-0.168 0.705-0.319 1.075-0.448 0.669-0.232 1.165-0.802 1.304-1.496l0.614-3.065 2.72-0.001 0.613 3.066c0.139 0.694 0.635 1.264 1.305 1.496 0.369 0.129 0.727 0.278 1.074 0.447 0.277 0.134 0.574 0.2 0.873 0.2 0.389 0 0.775-0.113 1.109-0.336l2.604-1.735 1.924 1.924-1.736 2.604c-0.393 0.59-0.443 1.343-0.137 1.98 0.168 0.347 0.32 0.705 0.449 1.075 0.232 0.669 0.801 1.165 1.496 1.304l3.064 0.614 0.003 2.72-3.066 0.614zM16 9.001c-3.865 0-7 3.135-7 7 0 3.866 3.135 7 7 7s7-3.135 7-7c0-3.865-3.135-7-7-7zM16 22.127c-3.382 0-6.125-2.744-6.125-6.125s2.743-6.125 6.125-6.125c3.381 0 6.125 2.743 6.125 6.125 0 3.381-2.744 6.125-6.125 6.125zM16 12.001c-2.21 0-4 1.79-4 4s1.79 4 4 4c2.209 0 4-1.791 4-4s-1.791-4-4-4zM16 19.002c-1.656 0-3-1.344-3-3s1.344-3 3-3 3 1.344 3 3c0 1.656-1.344 3-3 3z"></path>
</svg>
<!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>idea</title>
<path d="M16 0c-6.076 0-11 4.924-11 11 0 4.031 3.688 8.303 5.031 12.055 2.003 5.595 1.781 8.945 5.969 8.945 4.25 0 3.965-3.334 5.969-8.922 1.347-3.76 5.031-8.078 5.031-12.078 0-6.076-4.926-11-11-11zM18.592 27.176l-4.958 0.619c-0.177-0.512-0.367-1.111-0.598-1.893-0.003-0.010-0.007-0.021-0.009-0.031l6.188-0.773c-0.088 0.295-0.182 0.605-0.264 0.883-0.131 0.449-0.248 0.839-0.359 1.195zM12.736 24.908c-0.182-0.602-0.387-1.236-0.615-1.908h7.766c-0.123 0.359-0.246 0.719-0.352 1.059l-6.799 0.849zM16 30c-1.013 0-1.479-0.117-1.997-1.25l4.238-0.531c-0.614 1.654-1.061 1.781-2.241 1.781zM20.672 21h-9.333c-0.498-1.080-1.096-2.16-1.686-3.217-1.305-2.335-2.653-4.75-2.653-6.783 0-4.963 4.037-9 9-9s9 4.037 9 9c0 2.018-1.35 4.446-2.656 6.795-0.584 1.053-1.178 2.131-1.672 3.205zM16 5c0.275 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5c-2.757 0-5 2.243-5 5 0 0.276-0.224 0.5-0.5 0.5s-0.5-0.224-0.5-0.5c0-3.309 2.691-6 6-6z"></path>
</svg>
<br>Possible Rust</a></h1>
<p class="site-desc">Learning what&rsquo;s possible in Rust.</p>


    <nav class="site-nav">
        <ul class="site-nav-list">
            
                <li class="site-nav-item"><a href="/about"  title="About the site." ><div class="media"><div class="media-figure"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>about</title>
<path d="M31.11 28.336c-0.201-0.133-3.848-2.525-9.273-3.699 1.99-2.521 3.268-5.912 3.811-8.169 0.754-3.128 0.461-9.248-2.543-13.062-1.756-2.229-4.213-3.406-7.105-3.406s-5.349 1.178-7.104 3.406c-3.004 3.813-3.296 9.933-2.543 13.061 0.543 2.257 1.82 5.648 3.811 8.169-5.425 1.174-9.072 3.566-9.272 3.699-0.733 0.488-1.061 1.4-0.805 2.242 0.254 0.845 1.033 1.423 1.913 1.423h28c0.881 0 1.658-0.578 1.914-1.422 0.257-0.842-0.071-1.754-0.804-2.242zM20.267 23.398l-0.326 0.414c-2.385 2.74-5.495 2.74-7.879 0l-0.327-0.414c-2.785-3.529-4.167-8.197-3.572-12.65 0.545-4.279 2.997-8.748 7.837-8.748s7.293 4.47 7.838 8.749c0.593 4.455-0.784 9.118-3.571 12.649zM2 30c0.138-0.092 3.526-2.314 8.586-3.408l2.484-0.537c0.887 0.582 1.86 0.945 2.93 0.945 1.071 0 2.043-0.363 2.93-0.945l2.484 0.537c5.020 1.086 8.396 3.283 8.586 3.408h-28z"></path>
</svg>
</div><div class="media-body">About<span>About the site.</span></div></div></a></li>
            
                <li class="site-nav-item"><a href="/archive"  title="List of all posts." ><div class="media"><div class="media-figure"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>archives</title>
<path d="M16 0c-6.744 0-14 2.033-14 6.5v19c0 4.465 7.256 6.5 14 6.5s14-2.035 14-6.5v-19c0-4.467-7.258-6.5-14-6.5zM28 25.5c0 2.484-5.373 4.5-12 4.5-6.628 0-12-2.016-12-4.5v-3.736c2.066 2.129 7.050 3.236 12 3.236s9.934-1.107 12-3.236v3.736zM28 19.5h-0.004c0 0.010 0.004 0.021 0.004 0.031 0 2.469-5.373 4.469-12 4.469s-12-2-12-4.469c0-0.010 0.004-0.021 0.004-0.031h-0.004v-3.736c2.066 2.129 7.050 3.236 12 3.236s9.934-1.107 12-3.236v3.736zM28 13.5h-0.004c0 0.010 0.004 0.021 0.004 0.031 0 2.469-5.373 4.469-12 4.469s-12-2-12-4.469c0-0.010 0.004-0.021 0.004-0.031h-0.004v-3.436c2.621 1.997 7.425 2.936 12 2.936s9.379-0.939 12-2.936v3.436zM16 11c-6.628 0-12-2.016-12-4.5 0-2.486 5.372-4.5 12-4.5 6.627 0 12 2.014 12 4.5 0 2.484-5.373 4.5-12 4.5zM24 26c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM24 20c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM24 14c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1z"></path>
</svg>
</div><div class="media-body">Archive<span>List of all posts.</span></div></div></a></li>
            
                <li class="site-nav-item"><a href="/glossary"  title="Rust terms &amp; definitions." ><div class="media"><div class="media-figure"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>hacker-news</title>
<path d="M29 0h-22c-1.657 0-3 1.342-3 3v2h-1c-1.657 0-3 1.342-3 3v20c0 2.209 1.791 4 4 4h24c2.209 0 4-1.791 4-4v-25c0-1.658-1.344-3-3-3zM30 28c0 1.102-0.898 2-2 2h-24c-1.103 0-2-0.898-2-2v-20c0-0.552 0.448-1 1-1h1v20c0 0.553 0.447 1 1 1s1-0.447 1-1v-24c0-0.552 0.448-1 1-1h22c0.551 0 1 0.448 1 1v25zM19.498 13.005c-0.275 0-0.5-0.224-0.5-0.5s0.225-0.5 0.5-0.5h8c0.277 0 0.5 0.224 0.5 0.5s-0.223 0.5-0.5 0.5h-8zM19.498 10.005c-0.275 0-0.5-0.224-0.5-0.5s0.225-0.5 0.5-0.5h8c0.277 0 0.5 0.224 0.5 0.5s-0.223 0.5-0.5 0.5h-8zM19.498 7.005c-0.275 0-0.5-0.224-0.5-0.5s0.225-0.5 0.5-0.5h8c0.277 0 0.5 0.224 0.5 0.5s-0.223 0.5-0.5 0.5h-8zM16.5 27.004c0.276 0 0.5 0.225 0.5 0.5 0 0.277-0.225 0.5-0.5 0.5h-8c-0.276 0-0.5-0.223-0.5-0.5 0-0.275 0.224-0.5 0.5-0.5h8zM16.5 24.004c0.276 0 0.5 0.225 0.5 0.5 0 0.277-0.225 0.5-0.5 0.5h-8c-0.276 0-0.5-0.223-0.5-0.5 0-0.275 0.224-0.5 0.5-0.5h8zM16.5 21.004c0.276 0 0.5 0.225 0.5 0.5 0 0.277-0.225 0.5-0.5 0.5h-8c-0.276 0-0.5-0.223-0.5-0.5 0-0.275 0.224-0.5 0.5-0.5h8zM27.5 27.004c0.275 0 0.5 0.225 0.5 0.5 0 0.277-0.225 0.5-0.5 0.5h-8c-0.277 0-0.5-0.223-0.5-0.5 0-0.275 0.223-0.5 0.5-0.5h8zM27.5 24.004c0.275 0 0.5 0.225 0.5 0.5 0 0.277-0.225 0.5-0.5 0.5h-8c-0.277 0-0.5-0.223-0.5-0.5 0-0.275 0.223-0.5 0.5-0.5h8zM27.5 21.004c0.275 0 0.5 0.225 0.5 0.5 0 0.277-0.225 0.5-0.5 0.5h-8c-0.277 0-0.5-0.223-0.5-0.5 0-0.275 0.223-0.5 0.5-0.5h8zM27.5 15.004c0.275 0 0.5 0.224 0.5 0.5s-0.225 0.5-0.5 0.5h-19c-0.276 0-0.5-0.224-0.5-0.5s0.224-0.5 0.5-0.5h19zM27.5 18.004c0.275 0 0.5 0.225 0.5 0.5 0 0.277-0.225 0.5-0.5 0.5h-19c-0.276 0-0.5-0.223-0.5-0.5 0-0.275 0.224-0.5 0.5-0.5h19zM9 13h7c0.553 0 1-0.447 1-1v-6.996c0-0.553-0.447-1-1-1h-7c-0.553 0-1 0.447-1 1v6.996c0 0.552 0.447 1 1 1zM10 6h5v5h-5v-5z"></path>
</svg>
</div><div class="media-body">Glossary<span>Rust terms &amp; definitions.</span></div></div></a></li>
            
        </ul>
    </nav>

    <div class="categories">
        <h2 class="categories-title">Categories</h2>

        <nav class="category-nav">
            <ul class="categories-nav-list">
                
                    
                    
                    

                    
                        
                    
                        
                            <li class="categories-nav-item ">
                                <a href="/guide"><div class="media"><div class="media-figure"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>guide</title>
<path d="M16.002 17.746c3.309 0 6-2.692 6-6s-2.691-6-6-6c-3.309 0-6 2.691-6 6s2.691 6 6 6zM16.002 6.746c2.758 0 5 2.242 5 5s-2.242 5-5 5c-2.758 0-5-2.242-5-5s2.242-5 5-5zM16 0c-6.618 0-12 5.316-12 12.001 0 7 6.001 14.161 10.376 19.194 0.016 0.020 0.718 0.805 1.586 0.805 0.002 0 0.073 0 0.077 0 0.867 0 1.57-0.785 1.586-0.805 4.377-5.033 10.377-12.193 10.377-19.194 0-6.685-5.383-12.001-12.002-12.001zM16.117 29.883c-0.021 0.020-0.082 0.064-0.135 0.098-0.010-0.027-0.084-0.086-0.129-0.133-3.665-4.217-9.853-11.334-9.853-17.847 0-5.514 4.487-10.001 10-10.001 5.516 0 10.002 4.487 10.002 10.002 0 6.512-6.188 13.629-9.885 17.881z"></path>
</svg>
</div><div class="media-body">Guides<span>Explaining Rust concepts.</span></div></div></a>
                            </li>
                        
                    
                        
                    
                
                    
                    
                    

                    
                        
                            <li class="categories-nav-item ">
                                <a href="/pattern"><div class="media"><div class="media-figure"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>categories</title>
<path d="M22 9c-0.062 2.675-2.070 4.934-2.070 4.934 0-4.976-3.93-8.934-3.93-8.934s-0.053 2.962-2.043 5.948c-1.99-6.967-7.962-10.948-7.962-10.948 2.986 10.948-0.995 14.93-0.995 22.892 0 4.671 3.954 9.108 10 9.108 8.957 0 10.689-3.288 11.615-6.993 1.276-5.101-0.635-11.031-4.615-16.007zM24.676 24.521c-0.643 2.569-1.369 5.479-9.676 5.479-5.008 0-8-3.614-8-7.108 0-2.676 0.488-4.873 1.004-7.199 0.656-2.949 1.328-5.968 1.037-9.961 3.084 4.269 4.182 9.925 4.182 9.925s2.871-4.031 3.643-5.903c0.591 1.203 1.134 5.246 1.134 9.246 0 0 2.656-2.188 4.648-5.478 2.098 3.762 2.854 7.695 2.028 10.999zM22.432 16.795l0.186 1.035c0.416 2.318 0.183 5.058-0.592 6.982-0.078 0.195-0.266 0.313-0.463 0.313-0.063 0-0.127-0.012-0.188-0.036-0.256-0.103-0.381-0.394-0.277-0.65 0.584-1.449 0.83-3.489 0.674-5.353-1.004 1.122-2.269 2.291-4.972 3.575l-0.506 0.239-0.182-0.528c-0.362-1.050-0.727-2.111-0.885-3.59-0.541 0.853-1.035 1.613-1.865 2.743l-0.508 0.692-0.352-0.784c-0.861-1.925-1.517-3.428-2.037-4.75-0.481 1.545-0.84 3.332-0.84 6.941 0 0.276-0.225 0.5-0.5 0.5-0.277 0-0.5-0.224-0.5-0.5 0-4.709 0.625-6.523 1.285-8.444l0.52-1.51 0.479 1.35c0.515 1.451 1.193 3.050 2.152 5.212 0.632-0.893 1.056-1.565 1.568-2.376l1.518-2.378v1.709c0 1.924 0.346 3.181 0.727 4.323 2.659-1.338 3.655-2.502 4.708-3.73l0.85-0.985z"></path>
</svg>
</div><div class="media-body">Patterns<span>Tricks for real-world code.</span></div></div></a>
                            </li>
                        
                    
                        
                    
                        
                    
                
                    
                    
                    

                    
                        
                    
                        
                    
                        
                    
                
                    
                    
                    

                    
                        
                    
                        
                    
                        
                            <li class="categories-nav-item ">
                                <a href="/community"><div class="media"><div class="media-figure"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>community</title>
<path d="M15.5 0c-8.561 0-15.5 6.939-15.5 15.5s6.939 15.5 15.5 15.5 15.5-6.939 15.5-15.5-6.939-15.5-15.5-15.5zM28.975 15h-5.996c-0.055-2.215-0.449-4.331-1.148-6.268 1.35-0.563 2.598-1.312 3.736-2.197 2.023 2.271 3.288 5.22 3.408 8.465zM14.947 28.972c-1.662-1.384-3.056-3.181-4.076-5.268 1.309-0.409 2.696-0.633 4.129-0.679v5.949c-0.018 0-0.035-0.001-0.053-0.002zM16.051 2.028c1.886 1.57 3.425 3.673 4.466 6.126-1.426 0.487-2.941 0.77-4.518 0.82v-6.949c0.019 0.001 0.035 0.002 0.052 0.003zM17.717 2.198c2.76 0.459 5.236 1.748 7.164 3.614-1.047 0.803-2.191 1.483-3.428 1.998-0.91-2.157-2.187-4.064-3.736-5.612zM15 2.025v6.949c-1.577-0.051-3.093-0.333-4.518-0.82 1.041-2.453 2.58-4.556 4.466-6.126 0.018-0.001 0.034-0.002 0.052-0.003zM9.546 7.811c-1.235-0.515-2.38-1.195-3.427-1.998 1.927-1.866 4.404-3.155 7.164-3.614-1.55 1.547-2.826 3.454-3.737 5.612zM10.105 9.076c1.542 0.535 3.185 0.847 4.895 0.899v5.025h-5.979c0.054-2.094 0.425-4.095 1.084-5.924zM15 16v6.025c-1.577 0.048-3.102 0.306-4.539 0.769-0.866-2.062-1.377-4.359-1.44-6.794h5.979zM13.283 28.802c-2.473-0.411-4.719-1.488-6.545-3.052 0.985-0.683 2.050-1.261 3.188-1.7 0.872 1.808 2.013 3.413 3.357 4.752zM16 28.975v-5.949c1.432 0.046 2.82 0.27 4.129 0.679-1.021 2.087-2.414 3.884-4.076 5.268-0.017 0-0.035 0.001-0.053 0.002zM21.074 24.050c1.137 0.439 2.201 1.018 3.188 1.7-1.826 1.563-4.072 2.641-6.545 3.052 1.344-1.339 2.484-2.944 3.357-4.752zM20.539 22.794c-1.438-0.463-2.963-0.721-4.539-0.769v-6.025h5.979c-0.063 2.435-0.575 4.732-1.44 6.794zM16 15v-5.025c1.709-0.052 3.352-0.363 4.895-0.898 0.658 1.829 1.029 3.83 1.084 5.924h-5.979zM5.434 6.535c1.138 0.885 2.386 1.634 3.735 2.197-0.699 1.937-1.093 4.053-1.148 6.268h-5.996c0.12-3.245 1.385-6.194 3.409-8.465zM2.025 16h5.996c0.062 2.555 0.596 4.968 1.503 7.137-1.267 0.494-2.448 1.152-3.538 1.931-2.348-2.337-3.83-5.532-3.961-9.068zM25.014 25.067c-1.090-0.778-2.271-1.437-3.539-1.931 0.908-2.169 1.441-4.582 1.504-7.137h5.996c-0.131 3.537-1.614 6.732-3.961 9.068z"></path>
</svg>
</div><div class="media-body">Community<span>The language &amp; ecosystem.</span></div></div></a>
                            </li>
                        
                    
                
                    
                    
                    

                    
                        
                    
                        
                    
                        
                    
                
            </ul>    
        </nav>
    </div>

    <div class="tags">
        <h2 class="tags-title"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>tags</title>
<path d="M31.391 13.883l-5-8c-0.73-1.169-2.012-1.88-3.391-1.88h-19c-2.209 0-4 1.791-4 4v16c0 2.209 1.791 4 4 4h19c1.379 0 2.66-0.711 3.391-1.881l5-8c0.812-1.295 0.812-2.942 0-4.239zM29.695 17.062l-5 8.002c-0.367 0.588-1.002 0.939-1.695 0.939h-19c-1.103 0-2-0.898-2-2v-16c0-1.103 0.897-2 2-2h19c0.693 0 1.328 0.352 1.695 0.939l5 8c0.403 0.645 0.403 1.477 0 2.12zM23 13.003c-1.658 0-3 1.343-3 3s1.342 3 3 3c1.656 0 3-1.344 3-3 0-1.657-1.344-3-3-3zM23 18.004c-1.105 0-2-0.896-2-2s0.895-2 2-2c1.104 0 2 0.896 2 2s-0.896 2-2 2z"></path>
</svg>
 Tags</h2>

        <ul class="tags-list">
            
                <li class="tags-item">
                    <a class="plain" href="/tags#lints">#lints<span>1</span></a>
                </li>
            
                <li class="tags-item">
                    <a class="plain" href="/tags#enums">#enums<span>1</span></a>
                </li>
            
                <li class="tags-item">
                    <a class="plain" href="/tags#trait-objects">#trait objects<span>2</span></a>
                </li>
            
                <li class="tags-item">
                    <a class="plain" href="/tags#ffi">#ffi<span>1</span></a>
                </li>
            
                <li class="tags-item">
                    <a class="plain" href="/tags#opinion">#opinion<span>1</span></a>
                </li>
            
                <li class="tags-item">
                    <a class="plain" href="/tags#generics">#generics<span>1</span></a>
                </li>
            
                <li class="tags-item">
                    <a class="plain" href="/tags#functions">#functions<span>1</span></a>
                </li>
            
        </ul>

        <a class="tags-footer" href="/tags">View all tags</a>
    </div>

        <div class="social">
            <h2 class="social-title"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>social</title>
<path d="M31.543 0.16c-0.166-0.107-0.355-0.16-0.543-0.16-0.193 0-0.387 0.055-0.555 0.168l-30 20c-0.309 0.205-0.479 0.566-0.439 0.936 0.038 0.369 0.278 0.688 0.623 0.824l7.824 3.131 3.679 6.438c0.176 0.309 0.503 0.5 0.857 0.504 0.004 0 0.007 0 0.011 0 0.351 0 0.677-0.186 0.857-0.486l2.077-3.463 9.695 3.877c0.119 0.048 0.244 0.071 0.371 0.071 0.17 0 0.338-0.043 0.49-0.129 0.264-0.148 0.445-0.408 0.496-0.707l5-30c0.065-0.393-0.109-0.787-0.443-1.004zM3.136 20.777l23.175-15.451-16.85 18.037c-0.089-0.053-0.168-0.123-0.266-0.162l-6.059-2.424zM10.189 24.066c-0.002-0.004-0.005-0.006-0.007-0.010l18.943-20.275-16.149 25.162-2.787-4.877zM25.217 29.609l-8.541-3.416c-0.203-0.080-0.414-0.107-0.623-0.119l13.152-20.388-3.988 23.923z"></path>
</svg>
 Follow via&hellip;</h2>

            
                <div class="button-grid">
            

            
                <a class="button button--block" href="https://twitter.com/possiblerust"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>twitter</title>
<path d="M16 7c0.276 0 0.5 0.224 0.5 0.5s-0.225 0.5-0.5 0.5c-5.327 0-10 2.804-10 6 0 0.276-0.224 0.5-0.5 0.5s-0.5-0.224-0.5-0.5c0-3.794 5.037-7 11-7zM16 2c-8.837 0-16 5.373-16 12 0 4.127 2.779 7.766 7.008 9.926 0 0.027-0.008 0.045-0.008 0.074 0 1.793-1.339 3.723-1.928 4.736 0.001 0 0.002 0 0.002 0-0.047 0.11-0.074 0.231-0.074 0.358 0 0.5 0.405 0.906 0.906 0.906 0.094 0 0.259-0.025 0.255-0.014 3.125-0.512 6.069-3.383 6.753-4.215 0.999 0.147 2.029 0.229 3.086 0.229 8.835 0 16-5.373 16-12s-7.164-12-16-12zM16 24c-0.917 0-1.858-0.070-2.796-0.207-0.097-0.016-0.194-0.021-0.29-0.021-0.594 0-1.163 0.264-1.546 0.73-0.428 0.521-1.646 1.684-3.085 2.539 0.39-0.895 0.695-1.898 0.716-2.932 0.006-0.064 0.009-0.129 0.009-0.184 0-0.752-0.421-1.439-1.090-1.781-3.706-1.892-5.918-4.937-5.918-8.144 0-5.514 6.28-10 14-10 7.718 0 14 4.486 14 10s-6.281 10-14 10z"></path>
</svg>
Twitter</a>
            

            <a class="button button--block" href="/feed.xml"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>announcement</title>
<path d="M25 0c-2.053 0-3.666 1.41-4.824 3.586l-0.021-0.012c-1.682 3.293-4.186 5.426-6.929 5.426h-9.226c-2.243 0-4 2.197-4 5 0 2.805 1.757 5 4 5 1.103 0.004 1.995 0.896 1.995 2v9c0 1.105 0.896 2 2 2h4c1.104 0 2-0.895 2-2v-1c0-1-1-1.447-1-2v-7c0-0.023 0.016-0.039 0.018-0.062 0.010-0.143 0.049-0.275 0.112-0.395 0.018-0.033 0.037-0.059 0.059-0.088 0.080-0.119 0.181-0.217 0.304-0.293 0.006-0.004 0.008-0.010 0.014-0.014 0.004 0 0.007-0.004 0.011-0.004 0.080-0.045 0.176-0.055 0.266-0.080 2.524 0.268 4.809 2.305 6.377 5.373l0.025-0.012c1.159 2.169 2.768 3.575 4.819 3.575 4.596 0 7-7.043 7-14s-2.404-14-7-14zM20 14c0-1.037 0.061-2.039 0.164-3h2.836c1.104 0 2 1.344 2 3 0 1.658-0.896 3-2 3h-2.836c-0.103-0.961-0.164-1.961-0.164-3zM2 14c0-1.656 0.896-3 2-3h7.014c-0.62 0.729-1.014 1.787-1.014 3 0 1.215 0.394 2.273 1.014 3h-7.014c-1.104 0-2-1.342-2-3zM11.995 30h-4v-9c0-0.729-0.195-1.41-0.537-2h0.698v0.012h3.008c-0.107 0.311-0.169 0.641-0.169 0.988v7c0 0.963 0.538 1.604 0.859 1.986 0.044 0.053 0.096 0.107 0.141 0.166v0.848zM13.226 17.012h-0.226v-0.012c-1.104 0-2-1.342-2-3 0-1.656 0.896-3 2-3h0.226c1.886 0 3.652-0.742 5.206-2.018-0.286 1.61-0.432 3.315-0.432 5.018 0 1.709 0.146 3.42 0.434 5.031-1.555-1.277-3.322-2.019-5.208-2.019zM25 26c-2.018 0-3.75-2.871-4.541-7h2.541c2.242 0 4-2.195 4-5 0-2.803-1.758-5-4-5h-2.541c0.791-4.127 2.523-7 4.541-7 2.762 0 5 5.373 5 12s-2.238 12-5 12z"></path>
</svg>
Feed</a>

            
                </div>
            
        </div>
</header>


                <div class="site-content">
                            
                        <h2 class="site-title">Non-Generic Inner Functions</h2>
                        
                            <p class="post-preview-meta">
                                Oct 20th, 2020
 &middot;  <a href="/pattern" class="meta">Pattern</a>  
 &middot;  <a href="/tags#generics" class="meta">#generics</a>  
                            </p>
                        
                    

                    <div class="post " role="main">
    
    
    <div class="post-content" role="article">
        <p>Steve Klabnik recently wrote about <a href="https://steveklabnik.com/writing/are-out-parameters-idiomatic-in-rust">whether out parameters are idiomatic in Rust</a>. The post
ends by showing a snippet of code: a generic function, with a non-generic function inside of
it which contains the actual implementation. Steve says this pattern may warrant its own post,
so here is that post, where I’ll explain why this inner function is useful, discuss the
trade-offs of doing it, and describe why this pattern will hopefully not be necessary in
the future.</p>

<!-- more -->

<p>The snippet Steve showed is this one:</p>

<figure class="figure--code  " id="code-1">
    <a class="visually-hidden" href="#skip-code-1">Skip this content.</a>
    
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// Taken from https://steveklabnik.com/writing/are-out-parameters-idiomatic-in-rust</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="n">read_to_string</span><span class="o">&lt;</span><span class="n">P</span><span class="p">:</span> <span class="n">AsRef</span><span class="o">&lt;</span><span class="n">Path</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">P</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nn">io</span><span class="p">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">inner</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">Path</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nn">io</span><span class="p">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">file</span> <span class="o">=</span> <span class="nn">File</span><span class="p">::</span><span class="nf">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">string</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">with_capacity</span><span class="p">(</span><span class="nf">initial_buffer_size</span><span class="p">(</span><span class="o">&amp;</span><span class="n">file</span><span class="p">));</span>
        <span class="n">file</span><span class="nf">.read_to_string</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">string</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
        <span class="nf">Ok</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nf">inner</span><span class="p">(</span><span class="n">path</span><span class="nf">.as_ref</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></div></div>

    <figcaption><span class="figure-opener">Code 1</span> <p>The example code from Steve’s post.</p> <a href="#code-1" class="figure-link"><span>↺</span></a></figcaption>
    <div id="skip-code-1"></div>
</figure>

<p>Notice that the outer function is generic, taking anything which is convertible via
the <code class="language-plaintext highlighter-rouge">AsRef</code> trait into a <code class="language-plaintext highlighter-rouge">&amp;Path</code>, while the inner function is <em>not</em> generic, only taking in
a <code class="language-plaintext highlighter-rouge">&amp;Path</code>. The outer function does nothing but perform the <code class="language-plaintext highlighter-rouge">as_ref()</code> conversion and then
pass the result to the inner function.</p>

<p>So why have two functions at all?</p>

<p>Well, Rust generics are <em>monomorphized</em> at compile time. That means the compiler identifies
all the concrete types which any generic functions or types are called with throughout the
codebase, and generates copies of the generic code, specialized to the concrete types. So, for
example, if <code class="language-plaintext highlighter-rouge">read_to_string()</code> were called with a <code class="language-plaintext highlighter-rouge">PathBuf</code>, the compiler would generate a copy
of <code class="language-plaintext highlighter-rouge">read_to_string()</code> which takes a <code class="language-plaintext highlighter-rouge">PathBuf</code> specifically. This is how we can have code that is
both <em>generic</em> and <em>fast to call</em> (not involving any runtime checking to identify the implementation
to use).</p>

<p>We can imagine this monomorphization looks like this:</p>

<figure class="figure--code  " id="code-2">
    <a class="visually-hidden" href="#skip-code-2">Skip this content.</a>
    
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">path</span><span class="p">::{</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathBuf</span><span class="p">};</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">error</span><span class="p">::</span><span class="n">Error</span> <span class="k">as</span> <span class="n">StdError</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">fs</span><span class="p">::</span><span class="n">File</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">io</span><span class="p">::{</span><span class="k">self</span><span class="p">,</span> <span class="n">Read</span> <span class="k">as</span> <span class="mi">_</span><span class="p">};</span>

<span class="k">type</span> <span class="n">Error</span> <span class="o">=</span> <span class="nb">Box</span><span class="o">&lt;</span><span class="n">dyn</span> <span class="n">StdError</span> <span class="o">+</span> <span class="nb">Send</span> <span class="o">+</span> <span class="n">Sync</span> <span class="o">+</span> <span class="nv">'static</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c">// Copied from https://doc.rust-lang.org/src/std/fs.rs.html#198-203</span>
<span class="k">fn</span> <span class="nf">initial_buffer_size</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">File</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">usize</span> <span class="p">{</span>
    <span class="c">// Allocate one extra byte so the buffer doesn't need to grow before the</span>
    <span class="c">// final `read` call at the end of the file.  Don't worry about `usize`</span>
    <span class="c">// overflow because reading will fail regardless in that case.</span>
    <span class="n">file</span><span class="nf">.metadata</span><span class="p">()</span><span class="nf">.map</span><span class="p">(|</span><span class="n">m</span><span class="p">|</span> <span class="n">m</span><span class="nf">.len</span><span class="p">()</span> <span class="k">as</span> <span class="nb">usize</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="nf">.unwrap_or</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// Adapted from code in https://steveklabnik.com/writing/are-out-parameters-idiomatic-in-rust</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="n">read_to_string</span><span class="o">&lt;</span><span class="n">P</span><span class="p">:</span> <span class="n">AsRef</span><span class="o">&lt;</span><span class="n">Path</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">P</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nn">io</span><span class="p">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">file</span> <span class="o">=</span> <span class="nn">File</span><span class="p">::</span><span class="nf">open</span><span class="p">(</span><span class="n">path</span><span class="nf">.as_ref</span><span class="p">())</span><span class="o">?</span><span class="p">;</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">string</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">with_capacity</span><span class="p">(</span><span class="nf">initial_buffer_size</span><span class="p">(</span><span class="o">&amp;</span><span class="n">file</span><span class="p">));</span>
    <span class="n">file</span><span class="nf">.read_to_string</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">string</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
    <span class="nf">Ok</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="n">Result</span><span class="o">&lt;</span><span class="p">(),</span> <span class="n">Error</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">path</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">path</span> <span class="o">=</span> <span class="nn">PathBuf</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
        <span class="n">path</span><span class="nf">.push</span><span class="p">(</span><span class="s">"some"</span><span class="p">);</span>
        <span class="n">path</span><span class="nf">.push</span><span class="p">(</span><span class="s">"path"</span><span class="p">);</span>
        <span class="n">path</span><span class="nf">.push</span><span class="p">(</span><span class="s">"with"</span><span class="p">);</span>
        <span class="n">path</span><span class="nf">.push</span><span class="p">(</span><span class="s">"a"</span><span class="p">);</span>
        <span class="n">path</span><span class="nf">.push</span><span class="p">(</span><span class="s">"file.txt"</span><span class="p">);</span>
        <span class="n">path</span> <span class="c">// the path is now 'some/path/with/a/file.txt'</span>
    <span class="p">};</span>

    <span class="k">let</span> <span class="n">contents</span> <span class="o">=</span> <span class="nf">read_to_string</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

    <span class="nd">println!</span><span class="p">(</span><span class="s">"{}"</span><span class="p">,</span> <span class="n">contents</span><span class="p">);</span>

    <span class="nf">Ok</span><span class="p">(())</span>
<span class="p">}</span>

<span class="cm">/*
// At compile time, this could become:
use std::path::{Path, PathBuf};
use std::error::Error as StdError;
use std::fs::File;
use std::io::{self, Read as _};

type Error = Box&lt;dyn StdError + Send + Sync + 'static&gt;;

// Copied from https://doc.rust-lang.org/src/std/fs.rs.html#198-203
fn initial_buffer_size(file: &amp;File) -&gt; usize {
    // Allocate one extra byte so the buffer doesn't need to grow before the
    // final `read` call at the end of the file.  Don't worry about `usize`
    // overflow because reading will fail regardless in that case.
    file.metadata().map(|m| m.len() as usize + 1).unwrap_or(0)
}

// Adapted from code in https://steveklabnik.com/writing/are-out-parameters-idiomatic-in-rust
pub fn read_to_string_path_buf(path: PathBuf) -&gt; io::Result&lt;String&gt; {
    let mut file = File::open(path.as_ref())?;
    let mut string = String::with_capacity(initial_buffer_size(&amp;file));
    file.read_to_string(&amp;mut string)?;
    Ok(string)
}

fn main() -&gt; Result&lt;(), Error&gt; {
    let path = {
        let mut path = PathBuf::new();
        path.push("some");
        path.push("path");
        path.push("with");
        path.push("a");
        path.push("file.txt");
        path // the path is now 'some/path/with/a/file.txt'
    };

    let contents = read_to_string_path_buf(path)?;

    println!("{}", contents);

    Ok(())
}
}
*/</span>
</code></pre></div></div>

    <figcaption><span class="figure-opener">Code 2</span> <p>An example of what monomorphization looks like.</p> <a href="#code-2" class="figure-link"><span>↺</span></a></figcaption>
    <div id="skip-code-2"></div>
</figure>

<p>While the generated code doesn’t look too different from the original code, consider that some generic functions
may be called with a several different concrete types throughout a codebase, with each concrete type causing the
generation of a complete copy of the original generic code. This creates a tension and a trade-off between
<em>compilation speed and the size of the resulting binary</em> on one side and <em>generic, reusable code</em> on the other side.</p>

<p>To explain: Rust compilation is complicated and slow compilation times can have any number of causes, but code
generation is consistently identified as one of the slowest compilation phases. Monomorphization is one form of code
generation in Rust, so using generic code more heavily, and thus causing the generation of more concrete copies of a
generic function or type, contributes to a crate compiling slowly. Those copies are also done in their entirety,
meaning you may end up with a lot of repeated code in a binary, one for each version of the original, bloating
the resulting executable file.</p>

<aside id="aside-1">
    <h4><span class="aside-num">Aside 1:</span> <span class="aside-title">Dynamic Dispatch</span> <a href="#aside-1" class="aside-link"><span>↺</span></a></h4>
    <a class="visually-hidden" href="#skip-aside-1">Skip this content.</a>
    
<p>Another option to avoid bloating the binary is to perform dynamic dispatch via trait objects. With dynamic dispatch,
the determination of what concrete implementation of a generic function to call is performed at run-time, by
inspecting a table mapping types to function, which is stored alongside the data pointer in the trait object
structure, often called a “fat pointer.”</p>
    <div id="skip-aside-1"></div>
</aside>

<p>However, the ability to be generic and reusable is valuable, and taking in types like <code class="language-plaintext highlighter-rouge">AsRef&lt;Path&gt;</code> is often in
principle preferable to taking in a <code class="language-plaintext highlighter-rouge">&amp;Path</code> (this is why we have the standard conversion traits like <code class="language-plaintext highlighter-rouge">AsRef</code> or <code class="language-plaintext highlighter-rouge">Into</code>
in the first place).</p>

<p>So, what do you do?</p>

<p>Well, you can do what Steve does in his example. Most of the function body isn’t generic, the generic is simply to
be more flexible in the input type, which the function then converts into a single concrete type. So, you can create
a separate function which takes the converted-to type, and then have the generic function only perform the conversion
and then call the non-generic function. This way, the time spent generating code and the size of the generic code in the
resulting binary are both reduced.</p>

<p>You could do this pattern with a function outside of the original like so:</p>

<figure class="figure--code  " id="code-3">
    <a class="visually-hidden" href="#skip-code-3">Skip this content.</a>
    
<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// Adapted from https://steveklabnik.com/writing/are-out-parameters-idiomatic-in-rust</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="n">read_to_string</span><span class="o">&lt;</span><span class="n">P</span><span class="p">:</span> <span class="n">AsRef</span><span class="o">&lt;</span><span class="n">Path</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">P</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nn">io</span><span class="p">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="nf">inner</span><span class="p">(</span><span class="n">path</span><span class="nf">.as_ref</span><span class="p">())</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">inner</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">Path</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nn">io</span><span class="p">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">file</span> <span class="o">=</span> <span class="nn">File</span><span class="p">::</span><span class="nf">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">string</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">with_capacity</span><span class="p">(</span><span class="nf">initial_buffer_size</span><span class="p">(</span><span class="o">&amp;</span><span class="n">file</span><span class="p">));</span>
    <span class="n">file</span><span class="nf">.read_to_string</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">string</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
    <span class="nf">Ok</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

    <figcaption><span class="figure-opener">Code 3</span> <p>An example showing the inner function placed outside the original generic function.</p> <a href="#code-3" class="figure-link"><span>↺</span></a></figcaption>
    <div id="skip-code-3"></div>
</figure>

<p>However, this does pollute the namespace with a function which will only ever have one caller. The one question
before putting this <code class="language-plaintext highlighter-rouge">inner</code> function inside of <code class="language-plaintext highlighter-rouge">read_to_string</code> is: if the <code class="language-plaintext highlighter-rouge">inner</code> function is inside the generic
function, doesn’t it still contribute to code bloat?</p>

<p>The answer is no, and to prove it, let’s turn to the <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=e5bb21e2f315f5328f8a20ef37654f10">Rust Playground</a> and its ability to generate MIR (Rust’s
Mid-level Internal Representation, which is converted into LLVM IR and then into machine code). The MIR for
<code class="language-plaintext highlighter-rouge">read_to_string</code> in the above full code example looks like this:</p>

<figure class="figure--code  " id="code-4">
    <a class="visually-hidden" href="#skip-code-4">Skip this content.</a>
    
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fn read_to_string(_1: P) -&gt; std::result::Result&lt;std::string::String, std::io::Error&gt; {
    debug path =&gt; _1;                    // in scope 0 at src/main.rs:17:39: 17:43
    let mut _0: std::result::Result&lt;std::string::String, std::io::Error&gt;; // return place in scope 0 at src/main.rs:17:51: 17:69
    let mut _2: &amp;std::path::Path;        // in scope 0 at src/main.rs:24:11: 24:24
    let _3: &amp;std::path::Path;            // in scope 0 at src/main.rs:24:11: 24:24
    let mut _4: &amp;P;                      // in scope 0 at src/main.rs:24:11: 24:15

    bb0: {
        StorageLive(_2);                 // scope 0 at src/main.rs:24:11: 24:24
        StorageLive(_3);                 // scope 0 at src/main.rs:24:11: 24:24
        StorageLive(_4);                 // scope 0 at src/main.rs:24:11: 24:15
        _4 = &amp;_1;                        // scope 0 at src/main.rs:24:11: 24:15
        _3 = &lt;P as std::convert::AsRef&lt;std::path::Path&gt;&gt;::as_ref(move _4) -&gt; [return: bb2, unwind: bb3]; // scope 0 at src/main.rs:24:11: 24:24
                                         // mir::Constant
                                         // + span: src/main.rs:24:16: 24:22
                                         // + literal: Const { ty: for&lt;'r&gt; fn(&amp;'r P) -&gt; &amp;'r std::path::Path {&lt;P as std::convert::AsRef&lt;std::path::Path&gt;&gt;::as_ref}, val: Value(Scalar(&lt;ZST&gt;)) }
    }

    bb1 (cleanup): {
        resume;                          // scope 0 at src/main.rs:17:1: 25:2
    }

    bb2: {
        _2 = _3;                         // scope 0 at src/main.rs:24:11: 24:24
        StorageDead(_4);                 // scope 0 at src/main.rs:24:23: 24:24
        _0 = read_to_string::inner(move _2) -&gt; [return: bb4, unwind: bb3]; // scope 0 at src/main.rs:24:5: 24:25
                                         // mir::Constant
                                         // + span: src/main.rs:24:5: 24:10
                                         // + literal: Const { ty: for&lt;'r&gt; fn(&amp;'r std::path::Path) -&gt; std::result::Result&lt;std::string::String, std::io::Error&gt; {read_to_string::inner}, val: Value(Scalar(&lt;ZST&gt;)) }
    }

    bb3 (cleanup): {
        drop(_1) -&gt; bb1;                 // scope 0 at src/main.rs:25:1: 25:2
    }

    bb4: {
        StorageDead(_2);                 // scope 0 at src/main.rs:24:24: 24:25
        StorageDead(_3);                 // scope 0 at src/main.rs:25:1: 25:2
        drop(_1) -&gt; bb5;                 // scope 0 at src/main.rs:25:1: 25:2
    }

    bb5: {
        return;                          // scope 0 at src/main.rs:25:2: 25:2
    }
}
</code></pre></div></div>

    <figcaption><span class="figure-opener">Code 4</span> <p>A snippet of MIR showing the generic function is smaller with the non-generic inner function pattern.</p> <a href="#code-4" class="figure-link"><span>↺</span></a></figcaption>
    <div id="skip-code-4"></div>
</figure>

<p>This is a generated textual representation of MIR’s internal structure, so it may be a bit hard to read, but
this shows the function doing the conversion (inside the <code class="language-plaintext highlighter-rouge">bb0</code> section) and calling the inner function (inside
the <code class="language-plaintext highlighter-rouge">bb2</code> section). All the code which actually performs the file operations is contained inside the inner
function, which is split out and does not contribute to the size of the outer function in the generated code.</p>

<p>So, placing <code class="language-plaintext highlighter-rouge">inner</code> inside of the generic function limits its scope to only the callsite that needs it,
without harming our goal of reducing compile time and the size of the resulting binary.</p>

<p>The final question to ask in this situation is why the Rust compiler doesn’t just perform this optimization itself?
In an ideal world, the Rust compiler would see that most of the function isn’t generic, or that the parameters
are generic over one of the standard conversion trait, and would create an inner non-generic function and update
the original function to perform the conversion and call the inner function.</p>

<p>That’s not the reality right now. The compiler isn’t smart enough to do this, although it could in the future. If
it did, everyone could get the benefit of this pattern without having to remember to it themselves, which would be lovely.</p>

<p>So, to summarize:</p>

<ul>
  <li>The non-generic inner function pattern exists to reduce compile time and code bloat due to monomorphization
of certain sorts of generic functions.</li>
  <li>The inner function ought to be placed inside the generic function, which reduces its scope to only the relevant location
without causing any problems.</li>
  <li>Eventually, it would be nice if the Rust compiler could do this all automatically.</li>
</ul>


    </div>

    
        <div class="discuss">
            <div class="discuss-content">
                <section class="discuss-section">
                    <p><strong>Possible Rust</strong> succeeds when more people can join in learning about Rust! Please take a moment to share, <em>especially</em> if you have questions or if you disagree!</p>

                    <a target="_blank" href="https://twitter.com/intent/tweet?text=https://www.possiblerust.com/pattern/non-generic-inner-functions" class="button button--block">Share on Twitter</a>
                </section>
                <section class="discuss-section ">
                    
                        <h4>Discussions</h4>

                        <ul class="discuss-list">
                            
                            
                            
                                <li class="discuss-list-item"><a target="_blank" href="https://lobste.rs/s/02grfr/non_generic_inner_functions"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>lobsters</title>
<path d="M20.682 3.732c-0.473-0.472-1.1-0.732-1.768-0.732s-1.295 0.26-1.77 0.733l-1.41 1.412c-0.473 0.472-0.734 1.1-0.734 1.769 0 0.471 0.129 0.922 0.371 1.313l-13.577 5.439c-0.908 0.399-1.559 1.218-1.742 2.189-0.185 0.977 0.125 1.979 0.834 2.687l12.72 12.58c0.548 0.548 1.276 0.859 2.045 0.877 0.018 0.001 0.060 0.001 0.078 0.001 0.202 0 0.407-0.021 0.61-0.062 0.994-0.206 1.808-0.893 2.177-1.828l5.342-13.376c0.402 0.265 0.875 0.407 1.367 0.407 0.67 0 1.297-0.261 1.768-0.733l1.407-1.408c0.477-0.474 0.738-1.103 0.738-1.773s-0.262-1.3-0.732-1.768l-7.724-7.727zM16.659 29.367c-0.124 0.313-0.397 0.544-0.727 0.612-0.076 0.016-0.153 0.022-0.229 0.021-0.254-0.006-0.499-0.108-0.682-0.292l-12.728-12.588c-0.234-0.233-0.337-0.567-0.275-0.893 0.061-0.324 0.279-0.598 0.582-0.73l6.217-2.49c4.189 1.393 8.379 0.051 12.57 4.522l-4.728 11.838zM26.992 13.58l-1.414 1.413c-0.195 0.196-0.512 0.196-0.707 0l-1.768-1.767-1.432 3.589 0.119-0.303c-3.010-3.005-6.069-3.384-8.829-3.723-0.887-0.109-1.747-0.223-2.592-0.405l8.491-3.401-1.715-1.715c-0.195-0.195-0.195-0.512 0-0.707l1.414-1.415c0.195-0.195 0.512-0.195 0.707 0l7.725 7.727c0.198 0.195 0.198 0.512 0.001 0.707zM16.5 21c1.378 0 2.5-1.121 2.5-2.5s-1.121-2.5-2.5-2.5c-1.379 0-2.5 1.121-2.5 2.5s1.122 2.5 2.5 2.5zM16.5 17c0.828 0 1.5 0.672 1.5 1.5s-0.672 1.5-1.5 1.5c-0.829 0-1.5-0.672-1.5-1.5s0.671-1.5 1.5-1.5zM29.5 0c-1.379 0-2.5 1.121-2.5 2.5s1.121 2.5 2.5 2.5 2.5-1.121 2.5-2.5-1.121-2.5-2.5-2.5zM29.5 4c-0.828 0-1.5-0.672-1.5-1.5s0.672-1.5 1.5-1.5 1.5 0.672 1.5 1.5-0.672 1.5-1.5 1.5zM8 17c0 1.103 0.897 2 2 2s2-0.897 2-2-0.897-2-2-2-2 0.897-2 2zM10 16c0.552 0 1 0.447 1 1s-0.448 1-1 1-1-0.447-1-1 0.448-1 1-1zM12 23c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1zM28 8c0-0.552 0.448-1 1-1s1 0.448 1 1c0 0.552-0.448 1-1 1s-1-0.448-1-1z"></path>
</svg>
 Discuss on Lobste.rs</a></li>
                            
                            
                                <li class="discuss-list-item"><a target="_blank" href="https://old.reddit.com/r/rust/comments/jf43xp/nongeneric_inner_functions/"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>reddit</title>
<path d="M28.111 5.022l-1.215-3.655c-0.271-0.817-1.035-1.367-1.896-1.367h-18c-0.862 0-1.625 0.55-1.898 1.367l-1.225 3.657c-1.044 0.067-1.877 0.915-1.877 1.976v3c0 1.104 0.896 2 2 2h1.034c0 0.075-0.030 0.146-0.021 0.221l2 18c0.112 1.011 0.967 1.779 1.987 1.779h14c1.020 0 1.875-0.768 1.986-1.779l2-18c0.010-0.075-0.021-0.146-0.021-0.221h1.035c1.104 0 2-0.896 2-2v-3c0-1.065-0.84-1.917-1.889-1.978zM7 2h18l1 3h-20l1-3zM9 30l-0.333-3h14.666l-0.333 3h-14zM23.443 26h-14.888l-1.111-10h17.111l-1.112 10zM24.666 15h-17.333l-0.333-3h18l-0.334 3zM28 10h-24v-3h24v3z"></path>
</svg>
 Discuss on /r/Rust</a></li>
                            
                        </ul>
                    
                </section>
            </div>
        </div>
    

    <div class="other-posts">
        
            <a href="/guide/how-to-read-rust-functions-part-1">
                <span>Newer Post</span>
                <h4>How to Read Rust Functions, Part 1</h4>
            </a>
        

        
            <a href="/community/how-to-read-first-impression-posts">
                <span>Older Post</span>
                <h4>How to Read First Impression Posts</h4>
            </a>
        
    </div>
</div>

                </div>
            </div>
        </div>

        <footer class="site-footer">
    <div class="site-footer-body">
        <div class="site-footer-content">
            <div class="site-footer-aside">
                <span class="site-title site-title--small"><a href="/" class="plain"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>gear</title>
<path d="M30.391 12.68l-3.064-0.614c-0.154-0.443-0.336-0.873-0.537-1.289l1.736-2.604c0.529-0.793 0.424-1.85-0.25-2.523l-1.924-1.924c-0.387-0.387-0.898-0.586-1.416-0.586-0.383 0-0.77 0.11-1.107 0.336l-2.604 1.735c-0.418-0.202-0.848-0.382-1.291-0.536l-0.614-3.065c-0.186-0.936-1.008-1.608-1.961-1.608h-2.72c-0.953 0-1.774 0.673-1.961 1.608l-0.614 3.065c-0.443 0.154-0.873 0.335-1.289 0.536l-2.603-1.735c-0.339-0.226-0.725-0.336-1.109-0.336-0.517 0-1.028 0.199-1.415 0.586l-1.923 1.924c-0.674 0.674-0.779 1.73-0.25 2.523l1.735 2.604c-0.202 0.417-0.382 0.847-0.536 1.29l-3.066 0.613c-0.935 0.187-1.608 1.008-1.608 1.961v2.72c0 0.953 0.673 1.775 1.608 1.961l3.065 0.615c0.154 0.443 0.335 0.873 0.536 1.289l-1.734 2.604c-0.529 0.793-0.424 1.85 0.25 2.523l1.924 1.924c0.387 0.387 0.898 0.586 1.415 0.586 0.384 0 0.771-0.111 1.108-0.336l2.604-1.736c0.417 0.203 0.847 0.383 1.29 0.537l0.613 3.064c0.187 0.936 1.008 1.609 1.961 1.609h2.72c0.953 0 1.775-0.674 1.961-1.609l0.615-3.064c0.443-0.154 0.873-0.336 1.289-0.537l2.604 1.736c0.338 0.225 0.725 0.336 1.107 0.336 0.518 0 1.029-0.199 1.416-0.586l1.924-1.924c0.674-0.674 0.779-1.73 0.25-2.523l-1.736-2.604c0.203-0.418 0.383-0.848 0.537-1.291l3.064-0.613c0.935-0.185 1.609-1.008 1.609-1.961v-2.72c0-0.953-0.674-1.774-1.609-1.961zM26.934 17.975c-0.695 0.139-1.264 0.635-1.496 1.305-0.129 0.369-0.279 0.727-0.447 1.074-0.311 0.639-0.258 1.393 0.135 1.982l1.736 2.604-1.924 1.924-2.604-1.736c-0.334-0.223-0.721-0.336-1.109-0.336-0.297 0-0.596 0.066-0.871 0.199-0.348 0.168-0.705 0.32-1.076 0.449-0.668 0.232-1.164 0.801-1.303 1.496l-0.615 3.066h-2.72l-0.613-3.066c-0.139-0.695-0.635-1.264-1.304-1.496-0.369-0.129-0.728-0.279-1.075-0.447-0.276-0.135-0.574-0.201-0.872-0.201-0.389 0-0.775 0.113-1.109 0.336l-2.604 1.736-1.924-1.924 1.735-2.604c0.393-0.59 0.444-1.344 0.137-1.98-0.168-0.348-0.319-0.705-0.448-1.076-0.232-0.668-0.802-1.164-1.496-1.303l-3.065-0.615-0.002-2.721 3.066-0.613c0.694-0.139 1.264-0.635 1.496-1.304 0.129-0.369 0.278-0.728 0.447-1.075 0.31-0.638 0.258-1.392-0.136-1.981l-1.734-2.604 1.923-1.924 2.604 1.735c0.334 0.223 0.721 0.336 1.109 0.336 0.297 0 0.595-0.066 0.871-0.199 0.347-0.168 0.705-0.319 1.075-0.448 0.669-0.232 1.165-0.802 1.304-1.496l0.614-3.065 2.72-0.001 0.613 3.066c0.139 0.694 0.635 1.264 1.305 1.496 0.369 0.129 0.727 0.278 1.074 0.447 0.277 0.134 0.574 0.2 0.873 0.2 0.389 0 0.775-0.113 1.109-0.336l2.604-1.735 1.924 1.924-1.736 2.604c-0.393 0.59-0.443 1.343-0.137 1.98 0.168 0.347 0.32 0.705 0.449 1.075 0.232 0.669 0.801 1.165 1.496 1.304l3.064 0.614 0.003 2.72-3.066 0.614zM16 9.001c-3.865 0-7 3.135-7 7 0 3.866 3.135 7 7 7s7-3.135 7-7c0-3.865-3.135-7-7-7zM16 22.127c-3.382 0-6.125-2.744-6.125-6.125s2.743-6.125 6.125-6.125c3.381 0 6.125 2.743 6.125 6.125 0 3.381-2.744 6.125-6.125 6.125zM16 12.001c-2.21 0-4 1.79-4 4s1.79 4 4 4c2.209 0 4-1.791 4-4s-1.791-4-4-4zM16 19.002c-1.656 0-3-1.344-3-3s1.344-3 3-3 3 1.344 3 3c0 1.656-1.344 3-3 3z"></path>
</svg>
<!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>idea</title>
<path d="M16 0c-6.076 0-11 4.924-11 11 0 4.031 3.688 8.303 5.031 12.055 2.003 5.595 1.781 8.945 5.969 8.945 4.25 0 3.965-3.334 5.969-8.922 1.347-3.76 5.031-8.078 5.031-12.078 0-6.076-4.926-11-11-11zM18.592 27.176l-4.958 0.619c-0.177-0.512-0.367-1.111-0.598-1.893-0.003-0.010-0.007-0.021-0.009-0.031l6.188-0.773c-0.088 0.295-0.182 0.605-0.264 0.883-0.131 0.449-0.248 0.839-0.359 1.195zM12.736 24.908c-0.182-0.602-0.387-1.236-0.615-1.908h7.766c-0.123 0.359-0.246 0.719-0.352 1.059l-6.799 0.849zM16 30c-1.013 0-1.479-0.117-1.997-1.25l4.238-0.531c-0.614 1.654-1.061 1.781-2.241 1.781zM20.672 21h-9.333c-0.498-1.080-1.096-2.16-1.686-3.217-1.305-2.335-2.653-4.75-2.653-6.783 0-4.963 4.037-9 9-9s9 4.037 9 9c0 2.018-1.35 4.446-2.656 6.795-0.584 1.053-1.178 2.131-1.672 3.205zM16 5c0.275 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5c-2.757 0-5 2.243-5 5 0 0.276-0.224 0.5-0.5 0.5s-0.5-0.224-0.5-0.5c0-3.309 2.691-6 6-6z"></path>
</svg>
<br>Possible Rust</a></span>
            </div>
            <div class="site-footer-main">
                <section>
                    <ul>
                        <li><a class="plain" href="/about#about-andrew"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>about-andrew</title>
<path d="M31.11 28.336c-0.201-0.133-3.848-2.525-9.273-3.699 1.99-2.521 3.268-5.912 3.811-8.169 0.754-3.128 0.461-9.248-2.543-13.062-1.756-2.229-4.213-3.406-7.105-3.406s-5.349 1.178-7.104 3.406c-3.004 3.813-3.296 9.933-2.543 13.061 0.543 2.257 1.82 5.648 3.811 8.169-5.425 1.174-9.072 3.566-9.272 3.699-0.733 0.488-1.061 1.4-0.805 2.242 0.254 0.845 1.033 1.423 1.913 1.423h28c0.881 0 1.658-0.578 1.914-1.422 0.257-0.842-0.071-1.754-0.804-2.242zM20.267 23.398l-0.326 0.414c-2.385 2.74-5.495 2.74-7.879 0l-0.327-0.414c-2.785-3.529-4.167-8.197-3.572-12.65 0.545-4.279 2.997-8.748 7.837-8.748s7.293 4.47 7.838 8.749c0.593 4.455-0.784 9.118-3.571 12.649zM2 30c0.138-0.092 3.526-2.314 8.586-3.408l2.484-0.537c0.887 0.582 1.86 0.945 2.93 0.945 1.071 0 2.043-0.363 2.93-0.945l2.484 0.537c5.020 1.086 8.396 3.283 8.586 3.408h-28z"></path>
</svg>
 About Andrew</a></li>
                        <li><a class="plain" href="/about#about-the-site"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>about-the-site</title>
<path d="M27 4.996l-22 0.004c-0.553 0-1 0.443-1 0.996v14c0 0.553 0.447 1 1 1h22c0.553 0 1-0.447 1-1v-14c0-0.553-0.447-1-1-1zM27 20h-22v-14.004h22v14.004zM29 1h-26c-1.657 0-3 1.342-3 3v20c0 1.654 1.338 2.994 2.99 2.998h10.010v1.217l-6.242 0.811c-0.446 0.111-0.758 0.511-0.758 0.97 0 0.553 0.447 1 1 1h18c0.553 0 1-0.447 1-1 0-0.459-0.312-0.859-0.758-0.971l-6.242-0.81v-1.217h10.010c1.652-0.004 2.99-1.344 2.99-2.998v-20c0-1.658-1.344-3-3-3zM30 24c0 0.551-0.449 1-1 1h-26c-0.552 0-1-0.449-1-1v-20c0-0.552 0.448-1 1-1h26c0.551 0 1 0.448 1 1v20z"></path>
</svg>
 About the Site</a></li>
                    </ul>
                </section>
                <section>
                    <ul>
                        <li><a class="plain" href="https://twitter.com/PossibleRust"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>twitter</title>
<path d="M16 7c0.276 0 0.5 0.224 0.5 0.5s-0.225 0.5-0.5 0.5c-5.327 0-10 2.804-10 6 0 0.276-0.224 0.5-0.5 0.5s-0.5-0.224-0.5-0.5c0-3.794 5.037-7 11-7zM16 2c-8.837 0-16 5.373-16 12 0 4.127 2.779 7.766 7.008 9.926 0 0.027-0.008 0.045-0.008 0.074 0 1.793-1.339 3.723-1.928 4.736 0.001 0 0.002 0 0.002 0-0.047 0.11-0.074 0.231-0.074 0.358 0 0.5 0.405 0.906 0.906 0.906 0.094 0 0.259-0.025 0.255-0.014 3.125-0.512 6.069-3.383 6.753-4.215 0.999 0.147 2.029 0.229 3.086 0.229 8.835 0 16-5.373 16-12s-7.164-12-16-12zM16 24c-0.917 0-1.858-0.070-2.796-0.207-0.097-0.016-0.194-0.021-0.29-0.021-0.594 0-1.163 0.264-1.546 0.73-0.428 0.521-1.646 1.684-3.085 2.539 0.39-0.895 0.695-1.898 0.716-2.932 0.006-0.064 0.009-0.129 0.009-0.184 0-0.752-0.421-1.439-1.090-1.781-3.706-1.892-5.918-4.937-5.918-8.144 0-5.514 6.28-10 14-10 7.718 0 14 4.486 14 10s-6.281 10-14 10z"></path>
</svg>
 Twitter</a></li>
                        <li><a class="plain" href="/feed.xml"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>announcement</title>
<path d="M25 0c-2.053 0-3.666 1.41-4.824 3.586l-0.021-0.012c-1.682 3.293-4.186 5.426-6.929 5.426h-9.226c-2.243 0-4 2.197-4 5 0 2.805 1.757 5 4 5 1.103 0.004 1.995 0.896 1.995 2v9c0 1.105 0.896 2 2 2h4c1.104 0 2-0.895 2-2v-1c0-1-1-1.447-1-2v-7c0-0.023 0.016-0.039 0.018-0.062 0.010-0.143 0.049-0.275 0.112-0.395 0.018-0.033 0.037-0.059 0.059-0.088 0.080-0.119 0.181-0.217 0.304-0.293 0.006-0.004 0.008-0.010 0.014-0.014 0.004 0 0.007-0.004 0.011-0.004 0.080-0.045 0.176-0.055 0.266-0.080 2.524 0.268 4.809 2.305 6.377 5.373l0.025-0.012c1.159 2.169 2.768 3.575 4.819 3.575 4.596 0 7-7.043 7-14s-2.404-14-7-14zM20 14c0-1.037 0.061-2.039 0.164-3h2.836c1.104 0 2 1.344 2 3 0 1.658-0.896 3-2 3h-2.836c-0.103-0.961-0.164-1.961-0.164-3zM2 14c0-1.656 0.896-3 2-3h7.014c-0.62 0.729-1.014 1.787-1.014 3 0 1.215 0.394 2.273 1.014 3h-7.014c-1.104 0-2-1.342-2-3zM11.995 30h-4v-9c0-0.729-0.195-1.41-0.537-2h0.698v0.012h3.008c-0.107 0.311-0.169 0.641-0.169 0.988v7c0 0.963 0.538 1.604 0.859 1.986 0.044 0.053 0.096 0.107 0.141 0.166v0.848zM13.226 17.012h-0.226v-0.012c-1.104 0-2-1.342-2-3 0-1.656 0.896-3 2-3h0.226c1.886 0 3.652-0.742 5.206-2.018-0.286 1.61-0.432 3.315-0.432 5.018 0 1.709 0.146 3.42 0.434 5.031-1.555-1.277-3.322-2.019-5.208-2.019zM25 26c-2.018 0-3.75-2.871-4.541-7h2.541c2.242 0 4-2.195 4-5 0-2.803-1.758-5-4-5h-2.541c0.791-4.127 2.523-7 4.541-7 2.762 0 5 5.373 5 12s-2.238 12-5 12z"></path>
</svg>
 Atom Feed</a></li>
                    </ul>
                </section>
                <section>
                    <ul>
                        <li><a class="plain" href="/colophon"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>colophon</title>
<path d="M31.414 9.677l-5.080-5.081c-0.375-0.375-0.885-0.586-1.414-0.586h-17.839c-0.53 0-1.039 0.211-1.414 0.586l-5.080 5.081c-0.393 0.392-0.589 0.909-0.587 1.427 0.003 0.47 0.171 0.939 0.506 1.316l13.999 14.908c0.38 0.428 0.924 0.672 1.495 0.672s1.115-0.244 1.494-0.672l14-14.908c0.342-0.385 0.51-0.867 0.506-1.348-0.004-0.506-0.201-1.010-0.586-1.395zM18.219 11.010h-4.439l2.22-1.849 2.219 1.849zM16.782 8.51l2.732-2.278 2.018 2.018-2.532 2.109-2.218-1.849zM13 10.359l-2.532-2.109 2.018-2.018 2.733 2.278-2.219 1.849zM18.49 12.010l-2.49 12.453-2.49-12.453h4.98zM19.51 12.010h4.906l-7.359 12.269 2.453-12.269zM19.779 11.010l2.463-2.051 2.051 2.051h-4.514zM20.707 6.010h3.512l-1.916 1.597-1.596-1.597zM16 7.86l-2.22-1.85h4.438l-2.218 1.85zM9.696 7.607l-1.916-1.597h3.513l-1.597 1.597zM9.758 8.959l2.462 2.051h-4.513l2.051-2.051zM12.49 12.010l2.453 12.269-7.36-12.269h4.907zM12.704 22.488l-9.84-10.478h3.554l6.286 10.478zM25.582 12.010h3.555l-9.842 10.48 6.287-10.48zM25.707 11.010l-2.693-2.693 2.297-1.915 4.607 4.608h-4.211zM6.686 6.4l2.301 1.917-2.694 2.693h-4.287l4.68-4.61z"></path>
</svg>
 Colophon</a></li>
                        <li><a class="plain" href="/thanks"><!-- Generated by IcoMoon.io -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<title>thanks</title>
<path d="M29.193 5.265c-3.629-3.596-9.432-3.671-13.191-0.288-3.76-3.383-9.561-3.308-13.192 0.288-3.741 3.704-3.741 9.709 0 13.415 1.069 1.059 11.053 10.941 11.053 10.941 1.183 1.172 3.096 1.172 4.278 0 0 0 10.932-10.822 11.053-10.941 3.742-3.706 3.742-9.711-0.001-13.415zM27.768 17.268l-11.053 10.941c-0.393 0.391-1.034 0.391-1.425 0l-11.053-10.941c-2.95-2.92-2.95-7.671 0-10.591 2.844-2.815 7.416-2.914 10.409-0.222l1.356 1.22 1.355-1.22c2.994-2.692 7.566-2.594 10.41 0.222 2.95 2.919 2.95 7.67 0.001 10.591zM9.253 7.501c0.277 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5h-0.001c-1.794 0-3.249 1.455-3.249 3.249v0.001c0 0.276-0.224 0.5-0.5 0.5s-0.5-0.224-0.5-0.5v0c0-2.346 1.901-4.247 4.246-4.249 0.002 0 0.002-0.001 0.004-0.001z"></path>
</svg>
 Thanks</a></li>
                    </ul>
                </section>

                <section class="closure">
                    <p class="closure">Built on <a class="plain" href="https://jekyllrb.com">Jekyll</a>. Made by <a class="plain" href="https://github.com/alilleybrinker">Andrew Lilley Brinker</a>. &copy; 2021 All Rights Reserved.</p>
                </section>
            </div>
        </div>
    </div>
</footer>

    </body>
</html>
